# タスク仕様書テンプレート

## 📋 構成要素（5つのみ）

1. **目的**
2. **背景**
3. **/Command**
4. **目標**
5. **目標を達成するためのチェックリスト**

---

## ❌ 削除すべき要素

以下の情報は**タスク仕様書から削除**してください：
- SubAgent（/Commandが自動で呼び出す）
- Skill（SubAgentが自動で呼び出す）
- その他の技術的詳細（/Commandに含まれる）

---

## ✅ テンプレート

```markdown
# [タスク名]

## 1. 目的
[このタスクで達成したいこと]

## 2. 背景
[なぜこのタスクが必要なのか、現状の課題]

## 3. /Command
[コマンドリストから選択した/Commandを記載]

## 4. 目標
[タスク完了時に達成されているべき状態]

## 5. 目標を達成するためのチェックリスト
- [ ] [具体的な達成条件1]
- [ ] [具体的な達成条件2]
- [ ] [具体的な達成条件3]
```

---

## 📝 使用例

### 例：OAuth実装のタスク仕様書

```markdown
# OAuth実装タスク

## 1. 目的
Google OAuth認証を実装し、ユーザーがGmailアカウントでログインできるようにする

## 2. 背景
現在はダミーユーザー（ID=1）で動作確認中。本番環境ではOAuth認証が必要。
既にOAuth関連の関数（google_auth_url, google_exchange_code等）は実装済みだが、
/auth/callbackルートのエラーハンドリングとセキュリティ強化が必要。

## 3. /Command
/implement_oauth_authentication

## 4. 目標
- ユーザーがGoogleアカウントでログインできる
- トークンが安全に暗号化されて保存される
- エラーハンドリングが統一されている
- stateパラメータでCSRF対策が実装されている

## 5. 目標を達成するためのチェックリスト
- [ ] /auth/callbackルートのエラーハンドリングを統一（echoではなくrender_error使用）
- [ ] OAuth stateパラメータの検証を実装
- [ ] トークンの暗号化が正しく動作している
- [ ] セッション管理（session_regenerate_id, CSRF再生成）が正しく動作
- [ ] require_login()を復活させ、ダミーユーザーを削除
- [ ] 動作確認（ログイン→ログアウト→再ログイン）が成功
```

---

## 🎯 改善の効果

### 改善前の問題
- SubAgent、Skill、/Commandの情報が重複
- /Commandで設定したSubAgentとタスク仕様書で設定したSubAgentが矛盾
- 情報過多でAIが混乱
- 精度がばらつく

### 改善後の効果
- 情報の重複がなくなり、矛盾が発生しない
- /Commandが自動で必要なSubAgentとSkillを呼び出すため、設定漏れがない
- シンプルな構成でAIが理解しやすい
- 精度が安定する

---

**作成日**: 2026年1月2日
**更新**: タスク仕様書の簡素化（SubAgent、Skill削除）
