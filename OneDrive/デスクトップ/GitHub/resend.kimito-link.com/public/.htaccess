# 1) PHPファイルだけは明示的に許可（親の <FilesMatch \.php$> Deny を打ち消す）
<FilesMatch "\.php$">
    <IfModule mod_access_compat.c>
        Order Allow,Deny
        Allow from all
    </IfModule>
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
</FilesMatch>

# 2) ルーティング
RewriteEngine On

# 2-1) HTTPS強制（本番環境用）
RewriteCond %{HTTPS} off
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# 2-2) wwwなし統一
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^ https://%1%{REQUEST_URI} [R=301,L]

# 2-3) フロントコントローラールーティング
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ index.php [QSA,L]
